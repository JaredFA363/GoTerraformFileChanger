name: runner-automation-test
on:
  pull_request:
    branches:
      - master
    paths:
      - '.github/workflows/terraformChange.yml'
  push:
    branches:
      - master
    paths:
      - '.github/workflows/terraformChange.yml'

permissions:
  contents: read

jobs:
  test-runner-automation:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
    
      - name: Set up Go
        uses: actions/setup-go@v4
        with:
          go-version: '1.23'

      - name: Initialise Go modules
        run: |
          go mod init runner-automation
          go get github.com/hashicorp/hcl/v2
          go get github.com/hashicorp/hcl/v2/hclwrite
          go get github.com/zclconf/go-cty/cty
          go mod tidy
    
      - name: Run main.go
        run: go run runner-automation/main.go

      - name: Verify output with cat
        run: cat runner-automation/main.tf
